//  Copyright Open Logistics Foundation
//
//  Licensed under the Open Logistics Foundation License 1.3.
//  For details on the licensing terms, see the LICENSE file.
//  SPDX-License-Identifier: OLFL-1.3
//

#ifndef VDA5050_2B_2B_CORE_EVENTS_MESSAGE_EVENT_H_
#define VDA5050_2B_2B_CORE_EVENTS_MESSAGE_EVENT_H_

#include <memory>

#include "vda5050++/events/event_type.h"
#include "vda5050++/misc/connection_status.h"
#include "vda5050++/misc/message_error.h"
#include "vda5050/AgvFactsheet.h"
#include "vda5050/InstantActions.h"
#include "vda5050/Order.h"
#include "vda5050/State.h"
#include "vda5050/Visualization.h"

namespace vda5050pp::core::events {

///
///\brief The identifier type for MessageEvents
///
enum class MessageEventType {
  k_receive_order_message,
  k_valid_order_message,
  k_receive_instant_actions_message,
  k_valid_instant_actions_message,
  k_send_factsheet_message,
  k_send_state_message,
  k_send_visualization_message,
  k_connection_changed,
  k_message_error,
};

///
///\brief Message events are generated by the message module or by other modules,
/// that want the message module to send certain messages.
///
struct MessageEvent : vda5050pp::events::Event<MessageEventType> {};

///
///\brief This event is generated when a new order message was received.
/// The order is not yet validated.
///
struct ReceiveOrderMessageEvent
    : vda5050pp::events::EventId<MessageEvent, MessageEventType::k_receive_order_message> {
  ///\brief The order, that was received.
  std::shared_ptr<vda5050::Order> order;
};

///
///\brief This event is generated when a new order was validated and can be processed.
///
struct ValidOrderMessageEvent
    : vda5050pp::events::EventId<MessageEvent, MessageEventType::k_valid_order_message> {
  ///\brief The validated order.
  std::shared_ptr<vda5050::Order> valid_order;
};

///
///\brief This event is generated when a new instant actions message was received.
/// The instant actions are not yet validated.
///
struct ReceiveInstantActionMessageEvent
    : vda5050pp::events::EventId<MessageEvent,
                                 MessageEventType::k_receive_instant_actions_message> {
  ///\brief The instant actions, that were received.
  std::shared_ptr<vda5050::InstantActions> instant_actions;
};

struct ValidInstantActionMessageEvent
    : vda5050pp::events::EventId<MessageEvent, MessageEventType::k_valid_instant_actions_message> {
  ///\brief The valid instant actions
  std::shared_ptr<vda5050::InstantActions> valid_instant_actions;
};

///
///\brief This event should be handled by the message module. It contains the factsheet,
/// that shall be sent.
///
struct SendFactsheetMessageEvent
    : public vda5050pp::events::EventId<MessageEvent, MessageEventType::k_send_factsheet_message> {
  ///\brief The factsheet, that shall be sent.
  std::shared_ptr<vda5050::AgvFactsheet> factsheet;
};

///
///\brief This event should be handled by the message module. It contains the state,
/// that shall be sent.
///
struct SendStateMessageEvent
    : public vda5050pp::events::EventId<MessageEvent, MessageEventType::k_send_state_message> {
  ///\brief The state, that shall be sent.
  std::shared_ptr<vda5050::State> state;
};

///
///\brief This event should be handled by the message module. It contains the visualization,
/// that shall be sent.
///
struct SendVisualizationMessageEvent
    : public vda5050pp::events::EventId<MessageEvent,
                                        MessageEventType::k_send_visualization_message> {
  ///\brief The visualization, that shall be sent.
  std::shared_ptr<vda5050::Visualization> visualization;
};

///
///\brief This event is generated by the message module, when the connection status
/// has changed.
///
struct ConnectionChangedEvent
    : public vda5050pp::events::EventId<MessageEvent, MessageEventType::k_connection_changed> {
  ///\brief the status of the connection at the time of the event
  vda5050pp::misc::ConnectionStatus status;
};

///
///\brief This event is generated by the message module, when an error occurred.
/// Either when delivery or deserialization failed.
///
struct MessageErrorEvent
    : public vda5050pp::events::EventId<MessageEvent, MessageEventType::k_message_error> {
  ///\brief the type of the error
  vda5050pp::misc::MessageErrorType error_type;
  ///\brief a description of the error
  std::string description;
};

}  // namespace vda5050pp::core::events

#endif  // VDA5050_2B_2B_CORE_EVENTS_MESSAGE_EVENT_H_
